---
- name: "Ensure state of device: {{ name }}"
  device:
    server_url: "{{ phpipam_server_url }}"
    app_id: "{{ phpipam_app_id }}"
    username: "{{ phpipam_username }}"
    password: "{{ phpipam_password }}"
    hostname: "{{ device.hostname }}"
    ipaddress: "{{ device.ipaddress }}"
    description: "{{ device.description | default(omit) }}"
    sections: "{{ device.sections | list | default(omit) }}"
    rack: "{{ device.rack | default(omit) }}"
    starting_rack_unit: "{{ device.starting_rack_unit | default(omit) }}"
    rack_units: "{{ device.rack_units | default(omit) }}"
    snmp_community: "{{ device.snmp_community | default(omit) }}"
    snmp_version: "{{ device.snmp_version | default(omit) }}"
    snmp_port: "{{ device.snmp_port | default(omit) }}"
    snmp_timeout: "{{ device.snmp_timeout | default(omit) }}"
    snmp_queries: "{{ device.snmp_queries | default(omit) }}"
    snmp_v3_sec_level: "{{ device.snmp_v3_sec_level | default(omit) }}"
    snmp_v3_auth_protocol: "{{ device.snmp_v3_auth_protocol | default(omit) }}"
    snmp_v3_auth_pass: "{{ device.snmp_v3_auth_pass | default(omit) }}"
    snmp_v3_priv_protocol: "{{ device.snmp_v3_priv_protocol | default(omit) }}"
    snmp_v3_priv_pass: "{{ device.snmp_v3_priv_pass | default(omit) }}"
    snmp_v3_ctx_name: "{{ device.snmp_v3_ctx_name | default(omit) }}"
    snmp_v3_ctx_engine_id: "{{ device.snmp_v3_ctx_engine_id | default(omit) }}"
    state: "{{ device.state | default('present') }}"
